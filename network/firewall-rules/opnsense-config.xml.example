<?xml version="1.0"?>
<opnsense>
  <version>23.7</version>
  <theme>opnsense</theme>
  <sysctl>
    <item>
      <descr>Increase UFS read-ahead speeds to match the state of hard drives and NCQ.</descr>
      <tunable>vfs.read_max</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Set the ephemeral port range to be lower.</descr>
      <tunable>net.inet.ip.portrange.first</tunable>
      <value>default</value>
    </item>
  </sysctl>
  <system>
    <optimization>normal</optimization>
    <hostname>opnsense-gateway</hostname>
    <domain>smarthome.local</domain>
    <dnsallowoverride>1</dnsallowoverride>
    <group>
      <name>admins</name>
      <description>System Administrators</description>
      <scope>system</scope>
      <gid>1998</gid>
      <member>0</member>
      <priv>page-all</priv>
    </group>
    <user>
      <name>root</name>
      <descr>System Administrator</descr>
      <scope>system</scope>
      <groupname>admins</groupname>
      <password>$2y$10$YRVoF4SgskIsrXOvOQjGieB9XqHPRra9R7d80B3BZdbY/j21TwBfS</password>
      <uid>0</uid>
    </user>
    <nextuid>2000</nextuid>
    <nextgid>2000</nextgid>
    <timezone>Europe/Berlin</timezone>
    <timeservers>0.opnsense.pool.ntp.org 1.opnsense.pool.ntp.org</timeservers>
    <webgui>
      <protocol>https</protocol>
      <ssl-certref>63f4a1c2d5e8b</ssl-certref>
      <port></port>
      <ssl-ciphers></ssl-ciphers>
      <interfaces></interfaces>
      <compression>6</compression>
    </webgui>
    <disablenatreflection>yes</disablenatreflection>
    <usevirtualterminal>1</usevirtualterminal>
    <disableconsolemenu></disableconsolemenu>
    <disablevlanhwfilter>1</disablevlanhwfilter>
    <disablechecksumoffloading>1</disablechecksumoffloading>
    <disablesegmentationoffloading>1</disablesegmentationoffloading>
    <disablelargereceiveoffloading>1</disablelargereceiveoffloading>
    <ipv6allow></ipv6allow>
    <powerd_ac_mode>hadp</powerd_ac_mode>
    <powerd_battery_mode>hadp</powerd_battery_mode>
    <bogons>
      <interval>monthly</interval>
    </bogons>
    <kill_states></kill_states>
    <skip_rules_gw_down></skip_rules_gw_down>
    <use_mfs_tmpvar>1</use_mfs_tmpvar>
    <use_mfs_tmp_size>40</use_mfs_tmp_size>
    <use_mfs_var_size>60</use_mfs_var_size>
    <firmware version="1.0.0">
      <mirror></mirror>
      <flavour></flavour>
    </firmware>
  </system>
  <interfaces>
    <wan>
      <enable>1</enable>
      <if>em0</if>
      <mtu></mtu>
      <ipaddr>dhcp</ipaddr>
      <ipaddrv6>dhcp6</ipaddrv6>
      <subnet></subnet>
      <gateway></gateway>
      <blockpriv>1</blockpriv>
      <blockbogons>1</blockbogons>
      <dhcphostname></dhcphostname>
      <media></media>
      <mediaopt></mediaopt>
      <dhcp6-ia-pd-len>0</dhcp6-ia-pd-len>
    </wan>
    <lan>
      <enable>1</enable>
      <if>em1</if>
      <ipaddr>192.168.10.1</ipaddr>
      <subnet>24</subnet>
      <ipaddrv6>track6</ipaddrv6>
      <subnetv6>64</subnetv6>
      <media></media>
      <mediaopt></mediaopt>
      <track6-interface>wan</track6-interface>
      <track6-prefix-id>0</track6-prefix-id>
    </lan>
    <opt1>
      <enable>1</enable>
      <descr>TRUSTED</descr>
      <if>em1.20</if>
      <ipaddr>192.168.20.1</ipaddr>
      <subnet>24</subnet>
      <media></media>
      <mediaopt></mediaopt>
    </opt1>
    <opt2>
      <enable>1</enable>
      <descr>IOT</descr>
      <if>em1.30</if>
      <ipaddr>192.168.30.1</ipaddr>
      <subnet>24</subnet>
      <media></media>
      <mediaopt></mediaopt>
    </opt2>
    <opt3>
      <enable>1</enable>
      <descr>SECURITY</descr>
      <if>em1.40</if>
      <ipaddr>192.168.40.1</ipaddr>
      <subnet>24</subnet>
      <media></media>
      <mediaopt></mediaopt>
    </opt3>
    <opt4>
      <enable>1</enable>
      <descr>GUEST</descr>
      <if>em1.50</if>
      <ipaddr>192.168.50.1</ipaddr>
      <subnet>24</subnet>
      <media></media>
      <mediaopt></mediaopt>
    </opt4>
    <opt5>
      <enable>1</enable>
      <descr>QUARANTINE</descr>
      <if>em1.60</if>
      <ipaddr>192.168.60.1</ipaddr>
      <subnet>24</subnet>
      <media></media>
      <mediaopt></mediaopt>
    </opt5>
  </interfaces>
  <vlans>
    <vlan>
      <if>em1</if>
      <tag>20</tag>
      <pcp></pcp>
      <proto></proto>
      <descr>Trusted Devices</descr>
      <vlanif>em1.20</vlanif>
    </vlan>
    <vlan>
      <if>em1</if>
      <tag>30</tag>
      <pcp></pcp>
      <proto></proto>
      <descr>IoT Devices</descr>
      <vlanif>em1.30</vlanif>
    </vlan>
    <vlan>
      <if>em1</if>
      <tag>40</tag>
      <pcp></pcp>
      <proto></proto>
      <descr>Security Devices</descr>
      <vlanif>em1.40</vlanif>
    </vlan>
    <vlan>
      <if>em1</if>
      <tag>50</tag>
      <pcp></pcp>
      <proto></proto>
      <descr>Guest Network</descr>
      <vlanif>em1.50</vlanif>
    </vlan>
    <vlan>
      <if>em1</if>
      <tag>60</tag>
      <pcp></pcp>
      <proto></proto>
      <descr>Quarantine</descr>
      <vlanif>em1.60</vlanif>
    </vlan>
  </vlans>
  <dhcpd>
    <lan>
      <enable>1</enable>
      <ddnsdomainalgorithm>hmac-md5</ddnsdomainalgorithm>
      <numberoptions>
        <item></item>
      </numberoptions>
      <range>
        <from>192.168.10.100</from>
        <to>192.168.10.199</to>
      </range>
      <winsserver></winsserver>
      <dnsserver></dnsserver>
      <ntpserver></ntpserver>
    </lan>
    <opt1>
      <enable>1</enable>
      <ddnsdomainalgorithm>hmac-md5</ddnsdomainalgorithm>
      <numberoptions>
        <item></item>
      </numberoptions>
      <range>
        <from>192.168.20.100</from>
        <to>192.168.20.199</to>
      </range>
      <winsserver></winsserver>
      <dnsserver></dnsserver>
      <ntpserver></ntpserver>
    </opt1>
    <opt2>
      <enable>1</enable>
      <ddnsdomainalgorithm>hmac-md5</ddnsdomainalgorithm>
      <numberoptions>
        <item></item>
      </numberoptions>
      <range>
        <from>192.168.30.100</from>
        <to>192.168.30.199</to>
      </range>
      <winsserver></winsserver>
      <dnsserver></dnsserver>
      <ntpserver></ntpserver>
    </opt2>
    <opt3>
      <enable>1</enable>
      <ddnsdomainalgorithm>hmac-md5</ddnsdomainalgorithm>
      <numberoptions>
        <item></item>
      </numberoptions>
      <range>
        <from>192.168.40.100</from>
        <to>192.168.40.199</to>
      </range>
      <winsserver></winsserver>
      <dnsserver></dnsserver>
      <ntpserver></ntpserver>
    </opt3>
    <opt4>
      <enable>1</enable>
      <ddnsdomainalgorithm>hmac-md5</ddnsdomainalgorithm>
      <numberoptions>
        <item></item>
      </numberoptions>
      <range>
        <from>192.168.50.100</from>
        <to>192.168.50.199</to>
      </range>
      <winsserver></winsserver>
      <dnsserver></dnsserver>
      <ntpserver></ntpserver>
    </opt4>
    <opt5>
      <enable>1</enable>
      <ddnsdomainalgorithm>hmac-md5</ddnsdomainalgorithm>
      <numberoptions>
        <item></item>
      </numberoptions>
      <range>
        <from>192.168.60.100</from>
        <to>192.168.60.199</to>
      </range>
      <winsserver></winsserver>
      <dnsserver></dnsserver>
      <ntpserver></ntpserver>
    </opt5>
  </dhcpd>
  <filter>
    <rule>
      <id></id>
      <tracker>1</tracker>
      <type>block</type>
      <interface>wan</interface>
      <ipprotocol>inet</ipprotocol>
      <tag></tag>
      <tagged></tagged>
      <max></max>
      <max-src-nodes></max-src-nodes>
      <max-src-conn></max-src-conn>
      <max-src-states></max-src-states>
      <statetimeout></statetimeout>
      <statetype>keep state</statetype>
      <os></os>
      <protocol>any</protocol>
      <source>
        <network>any</network>
      </source>
      <destination>
        <network>any</network>
      </destination>
      <descr>Block all WAN to any</descr>
      <updated>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </updated>
      <created>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </created>
    </rule>
    <rule>
      <id></id>
      <tracker>2</tracker>
      <type>pass</type>
      <interface>lan</interface>
      <ipprotocol>inet</ipprotocol>
      <tag></tag>
      <tagged></tagged>
      <max></max>
      <max-src-nodes></max-src-nodes>
      <max-src-conn></max-src-conn>
      <max-src-states></max-src-states>
      <statetimeout></statetimeout>
      <statetype>keep state</statetype>
      <os></os>
      <protocol>any</protocol>
      <source>
        <network>lan</network>
      </source>
      <destination>
        <network>any</network>
      </destination>
      <descr>Allow LAN to any</descr>
      <updated>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </updated>
      <created>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </created>
    </rule>
    <rule>
      <id></id>
      <tracker>3</tracker>
      <type>pass</type>
      <interface>opt1</interface>
      <ipprotocol>inet</ipprotocol>
      <tag></tag>
      <tagged></tagged>
      <max></max>
      <max-src-nodes></max-src-nodes>
      <max-src-conn></max-src-conn>
      <max-src-states></max-src-states>
      <statetimeout></statetimeout>
      <statetype>keep state</statetype>
      <os></os>
      <protocol>tcp</protocol>
      <source>
        <network>opt1</network>
      </source>
      <destination>
        <network>opt2</network>
        <port>80</port>
      </destination>
      <descr>Allow Trusted to IoT HTTP</descr>
      <updated>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </updated>
      <created>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </created>
    </rule>
    <rule>
      <id></id>
      <tracker>4</tracker>
      <type>pass</type>
      <interface>opt1</interface>
      <ipprotocol>inet</ipprotocol>
      <tag></tag>
      <tagged></tagged>
      <max></max>
      <max-src-nodes></max-src-nodes>
      <max-src-conn></max-src-conn>
      <max-src-states></max-src-states>
      <statetimeout></statetimeout>
      <statetype>keep state</statetype>
      <os></os>
      <protocol>tcp</protocol>
      <source>
        <network>opt1</network>
      </source>
      <destination>
        <network>opt3</network>
        <port>80</port>
      </destination>
      <descr>Allow Trusted to Security HTTP</descr>
      <updated>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </updated>
      <created>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </created>
    </rule>
    <rule>
      <id></id>
      <tracker>5</tracker>
      <type>block</type>
      <interface>opt2</interface>
      <ipprotocol>inet</ipprotocol>
      <tag></tag>
      <tagged></tagged>
      <max></max>
      <max-src-nodes></max-src-nodes>
      <max-src-conn></max-src-conn>
      <max-src-states></max-src-states>
      <statetimeout></statetimeout>
      <statetype>keep state</statetype>
      <os></os>
      <protocol>any</protocol>
      <source>
        <network>opt2</network>
      </source>
      <destination>
        <network>lan</network>
      </destination>
      <descr>Block IoT to LAN</descr>
      <updated>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </updated>
      <created>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </created>
    </rule>
    <rule>
      <id></id>
      <tracker>6</tracker>
      <type>block</type>
      <interface>opt2</interface>
      <ipprotocol>inet</ipprotocol>
      <tag></tag>
      <tagged></tagged>
      <max></max>
      <max-src-nodes></max-src-nodes>
      <max-src-conn></max-src-conn>
      <max-src-states></max-src-states>
      <statetimeout></statetimeout>
      <statetype>keep state</statetype>
      <os></os>
      <protocol>any</protocol>
      <source>
        <network>opt2</network>
      </source>
      <destination>
        <network>opt1</network>
      </destination>
      <descr>Block IoT to Trusted</descr>
      <updated>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </updated>
      <created>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </created>
    </rule>
    <rule>
      <id></id>
      <tracker>7</tracker>
      <type>pass</type>
      <interface>opt2</interface>
      <ipprotocol>inet</ipprotocol>
      <tag></tag>
      <tagged></tagged>
      <max></max>
      <max-src-nodes></max-src-nodes>
      <max-src-conn></max-src-conn>
      <max-src-states></max-src-states>
      <statetimeout></statetimeout>
      <statetype>keep state</statetype>
      <os></os>
      <protocol>tcp</protocol>
      <source>
        <network>opt2</network>
      </source>
      <destination>
        <network>wan</network>
        <port>80</port>
      </destination>
      <descr>Allow IoT to Internet HTTP</descr>
      <updated>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </updated>
      <created>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </created>
    </rule>
    <rule>
      <id></id>
      <tracker>8</tracker>
      <type>pass</type>
      <interface>opt2</interface>
      <ipprotocol>inet</ipprotocol>
      <tag></tag>
      <tagged></tagged>
      <max></max>
      <max-src-nodes></max-src-nodes>
      <max-src-conn></max-src-conn>
      <max-src-states></max-src-states>
      <statetimeout></statetimeout>
      <statetype>keep state</statetype>
      <os></os>
      <protocol>tcp</protocol>
      <source>
        <network>opt2</network>
      </source>
      <destination>
        <network>wan</network>
        <port>443</port>
      </destination>
      <descr>Allow IoT to Internet HTTPS</descr>
      <updated>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </updated>
      <created>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </created>
    </rule>
    <rule>
      <id></id>
      <tracker>9</tracker>
      <type>block</type>
      <interface>opt5</interface>
      <ipprotocol>inet</ipprotocol>
      <tag></tag>
      <tagged></tagged>
      <max></max>
      <max-src-nodes></max-src-nodes>
      <max-src-conn></max-src-conn>
      <max-src-states></max-src-states>
      <statetimeout></statetimeout>
      <statetype>keep state</statetype>
      <os></os>
      <protocol>any</protocol>
      <source>
        <network>opt5</network>
      </source>
      <destination>
        <network>any</network>
      </destination>
      <descr>Block Quarantine to any</descr>
      <updated>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </updated>
      <created>
        <time>1640995200</time>
        <username>root@192.168.10.50</username>
      </created>
    </rule>
  </filter>
  <nat>
    <outbound>
      <mode>automatic</mode>
    </outbound>
  </nat>
  <aliases>
    <alias>
      <name>IoT_Devices</name>
      <type>network</type>
      <address>192.168.30.0/24</address>
      <descr>IoT Device Network</descr>
      <detail>IoT Device Network</detail>
    </alias>
    <alias>
      <name>Security_Devices</name>
      <type>network</type>
      <address>192.168.40.0/24</address>
      <descr>Security Device Network</descr>
      <detail>Security Device Network</detail>
    </alias>
    <alias>
      <name>Trusted_Devices</name>
      <type>network</type>
      <address>192.168.20.0/24</address>
      <descr>Trusted Device Network</descr>
      <detail>Trusted Device Network</detail>
    </alias>
    <alias>
      <name>Management_Network</name>
      <type>network</type>
      <address>192.168.10.0/24</address>
      <descr>Management Network</descr>
      <detail>Management Network</detail>
    </alias>
  </aliases>
  <dnsmasq>
    <enable>1</enable>
    <regdhcp>1</regdhcp>
    <regdhcpstatic>1</regdhcpstatic>
    <dhcpfirst>1</dhcpfirst>
    <strict_order>1</strict_order>
    <domain_needed>1</domain_needed>
    <no_private_reverse>1</no_private_reverse>
    <port>53</port>
    <custom_options>
      # Block known malicious domains
      address=/malware.example.com/127.0.0.1
      address=/botnet.example.com/127.0.0.1
      
      # Local domain resolution
      local=/smarthome.local/
      domain=smarthome.local
    </custom_options>
  </dnsmasq>
  <snmpd>
    <syslocation></syslocation>
    <syscontact></syscontact>
    <rocommunity>public</rocommunity>
    <enable>1</enable>
    <bindlan>1</bindlan>
  </snmpd>
  <syslog>
    <reverse></reverse>
    <nentries>50</nentries>
    <remoteserver>192.168.10.100</remoteserver>
    <remoteserver2></remoteserver2>
    <remoteserver3></remoteserver3>
    <sourceip></sourceip>
    <ipproto>ipv4</ipproto>
    <filter>1</filter>
    <dhcp>1</dhcp>
    <auth>1</auth>
    <enable>1</enable>
  </syslog>
  <cron>
    <item>
      <minute>0</minute>
      <hour>3</hour>
      <mday>*</mday>
      <month>*</month>
      <wday>*</wday>
      <who>root</who>
      <command>/usr/local/bin/pfctl -t bogons -T flush</command>
    </item>
    <item>
      <minute>1</minute>
      <hour>3</hour>
      <mday>*</mday>
      <month>*</month>
      <wday>*</wday>
      <who>root</who>
      <command>/etc/rc.update_bogons.sh</command>
    </item>
  </cron>
</opnsense>